function dudt=PACM_prime(t, u, population)
G = [3.25, 3.25, 30, 10, 3.25, 30, 10, 3.25, 3.25, 30, 10, 3.25, 30, 10]';
k = [60, 70, 30, 350, 60, 30, 350, 60, 70, 30, 350, 60, 30, 350]';

e0 = 5;
p = zeros(14, 1);
p(5) = 500;
p(7) = 150;
v0 = 6;
r = 0.56;
b = 0.001;

gamma = [
    19.23, 12.53, 34.17, 14.07, 1.61, 0, 0, 3.82, 1.61, 0, 0, 0, 0, 0;
    12.53, 12.53, 27.47, 14.07, 1.61, 0, 0, 3.82, 1.61, 0, 0, 0, 0, 0;
    -23.45, -23.45, -52.93, -6.70, 0, 0, 0, -23.45, -33.50, 0, 0, -16.75, -16.75, -11.39;
    -3.35, -5.36, -6.03, -20.1, 0, 0, 0, -3.35, -6.70, 0, -2.01, -3.35, 0, -2.01;
    9.72, 0, 0, 0, 22.98, 34.17, 58.96, 7.77, 8.17, 0, 2.14, 0, 0, 0;
    0, 0, 0, 0, -23.45, -52.93, -8.71, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, -6.03, -6.03, -61.64, 0, 0, 0, 0, 0, 0, 0;
    1.47, 0, 0, 0, 0.47, 0, 0, 32.89, 5.36, 20.77, 8.71, 2.14, 0, 0;
    1.21, 0, 0, 0, 1.14, 0, 0, 46.90, 20.77, 8.71, 4.69, 0, 0, 0;
    -23.45, 0, 0, 0, -23.45, -23.45, -52.93, -2.01, -16.75, 0, -5.36, 0, 0, 0;
    0, 0, 0, 0, -2.68, -2.68, -61.64, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0.40, 1.88, 0, 0, 48.78, 34.17, 15.41;
    -23.45, 0, 0, 0, 0, 0, 0, -16.75, -16.75, -5.36, -23.45, -66.33, -8.71, 0;
    0, 0, 0, 0, 0, 0, 0, -9.38, -29.48, -28.14, 0, 0, 0, 0;
];

gamma = gamma * population;
x = u(1:14);
dx = u(15:28);

S_x = e0 ./ (1 + exp(r * (v0 - x)));

ddx = -2 .* k .* b .* dx - k.^2 .* x + G .* k .* (p + gamma * S_x);

dudt=[dx; ddx]; %necessary to return a column vector

end